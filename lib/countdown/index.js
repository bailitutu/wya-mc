"use strict";var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},COUNTDOWN_MODE=["DD天hh时mm分ss秒","hh:mm:ss","hh时mm分ss秒","mm:ss","mm分ss秒"];Component({properties:{mode:{type:String,value:""},countStyle:{type:String,value:""},unitStyle:{type:String,value:""},isListen:{type:Boolean,value:!1}},externalClasses:["count-class"],data:{day:"0",hour:"00",min:"00",sec:"00",serverOffset:0,isEnd:0},detached:function(){var t=this.data.timer;t&&clearTimeout(t)},methods:{start:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.data.isEnd,s=e.serverTime,a=void 0===s?0:s,i=(e.targetTime,e.wait),n=void 0===i?1e3:i;if(this.setData(_extends({},e,{serverOffset:a?1e3*a-(new Date).getTime():0})),!r){var o=setInterval(function(){t.runStart()},n);this.setData({timer:o})}},getCurrentDate:function(){var t=this.data.serverOffset,e=new Date;return new Date(e.getTime()+Number(t))},runStart:function(){var t=this.data,e=t.targetTime,r=t.mode,s=t.isListen,a=this.getCurrentDate().getTime(),i=1e3*e-a;if(i<0)this.runEnd();else{var n=1e3,o=6e4,h=36e5;if(!r||-1==COUNTDOWN_MODE.indexOf(r))throw new Error("倒计时格式不是组件允许范围内");var m=0,d=0,l=void 0,u=void 0;"DD天hh时mm分ss秒"===r?(m=Math.floor(i/864e5),d=Math.floor(i%864e5/h),l=Math.floor(i%h/o),u=Math.floor(i%o/n)):"hh:mm:ss"===r||"hh时mm分ss秒"===r?(d=Math.floor(i/h),l=Math.floor(i%h/o),u=Math.floor(i%o/n)):"mm:ss"!==r&&"mm分ss秒"!==r||(l=Math.floor(i/o),u=Math.floor(i%o/n)),this.setData({day:m<10?0==m?m:"0"+m:m,hour:d<10?"0"+d:d,min:l<10?"0"+l:l,sec:u<10?"0"+u:u}),i<1e3?(this.setData({isEnd:1}),this.runEnd()):s&&this.triggerEvent("listen",{currentDate:a})}},runEnd:function(){var t=this.data.timer;t&&clearInterval(t),this.data.isEnd&&this.triggerEvent("end",{})}}});